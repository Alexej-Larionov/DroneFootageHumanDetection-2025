# Архипелаг-2025
Решение задачи хакатона Архипелаг 2025 - поиск людей на изображениях полученных при помощи БАС
Данный репозиторий является итогом попытки решить задачу детекции людей на изображениях снятых с дронов. Обучающая и валидационная выборки состояли из изображений в различном разрешении, разного масштаба, были сняты в различных условиях, как в природных так и в техногенных.
<img width="549" height="482" alt="image" src="https://github.com/user-attachments/assets/0da87367-d615-440b-baa0-ec991b52a60f" />
Таргеты равномерно распределены, среднем один инстанс целевого класса занимает очень малую площадь относительно размера изображения, так что было принято решение использовать подход со скользящим окном размера 640*640 и шагом в 560.
<img width="428" height="547" alt="image" src="https://github.com/user-attachments/assets/48d8c406-faed-44a5-811c-46c5981346ad" />
Так же на этом этапе были отсечены изображения на которых bbox таргетов были отнесены к выбросам (занимали значительно большую площадь).
<img width="590" height="590" alt="image" src="https://github.com/user-attachments/assets/68363100-9ff1-4c02-8c41-b5fa0a8dde74" />
Как упоминалось ранее изображения сняты в разных природных условиях в свете чего было принято решение на этапе препроцессинга рассчитывать для изображения нормализованные медианные значения для компонент HSV, а так же нормализованную энтропию по каналам для дальнейшей кластеризации на основе этих параметров. 
<img width="1555" height="573" alt="image" src="https://github.com/user-attachments/assets/da8d8d0c-00f3-4ac4-abd5-347f7134beba" />
Для каждого кластера были применены препроцессинг и обучена отдельная модель на основе YOLO11L. 
<img width="1989" height="396" alt="image" src="https://github.com/user-attachments/assets/4fdb138b-eea7-478a-9f6c-b53148624e27" />
Модели обучались на заранее подготовленных тайлах 640*640. Из-за большого количества пустых тайлов была предпринята попытка снизить вычислительную нагрузку путем создания маски по тону и удаления тайлов полностью пересекающихся с маской.
![купцукп](https://github.com/user-attachments/assets/ba0b5009-be0d-4e9c-8642-f14d86fb047f)
Как итог решение разделить модель оказалось ошибочным, выборки для каждой модели получились небольшими - недостаточными для стабильной генерализации. Так же проблемой стала мерджинг боксов с множества перекрывающихся тайлов.
<img width="1920" height="1920" alt="image" src="https://github.com/user-attachments/assets/a71ba80f-087e-4bbc-b5a2-7972f38c8349" />
Финальный скор ~0,29.
